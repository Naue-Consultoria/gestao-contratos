<app-login-layout [title]="formStage === 'request' ? 'Recuperar Senha' : 'Verifique seu Email'">
    <img src="/logoNaue.png" alt="Naue Consultoria" class="login-logo"/>

    <div *ngIf="formStage === 'request'">
        <div class="info-text">
            <i class="fas fa-info-circle"></i>
            <p>Digite seu email cadastrado e enviaremos um código para recuperar sua senha.</p>
        </div>
        
        <form [formGroup]="requestForm" (ngSubmit)="requestReset()">
            <app-login-primary-input
                formControlName="email"
                inputName="email"
                type="email"
                label="Email"
                placeholder="Digite seu email cadastrado">
            </app-login-primary-input>
            
            <button type="submit" class="btn-primary" [disabled]="isLoading || requestForm.invalid">
                <span *ngIf="!isLoading">Enviar Código</span>
                <span *ngIf="isLoading"><i class="fas fa-spinner fa-spin"></i> Enviando...</span>
            </button>
        </form>
    </div>

    <div *ngIf="formStage === 'validate'">
        <div class="success-message">
            <div class="success-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <h3>Verifique seu Email!</h3>
            <p>Se uma conta existir para <strong>{{ requestForm.value.email }}</strong>, você receberá um código de recuperação.</p>
        </div>

        <form [formGroup]="resetForm" (ngSubmit)="resetPassword()">
            <app-login-primary-input
                formControlName="code"
                inputName="code"
                type="text"
                label="Código de Verificação"
                placeholder="Insira o código de 6 dígitos">
            </app-login-primary-input>

            <app-login-primary-input
                formControlName="password"
                inputName="password"
                type="password"
                label="Nova Senha"
                placeholder="Digite sua nova senha">
            </app-login-primary-input>
            
            <button type="submit" class="btn-primary" [disabled]="isLoading || resetForm.invalid">
                <span *ngIf="!isLoading">Alterar Senha</span>
                <span *ngIf="isLoading"><i class="fas fa-spinner fa-spin"></i> Alterando...</span>
            </button>
        </form>
    </div>

    <a class="back-to-login" routerLink="/login">
        <i class="fas fa-arrow-left"></i> Voltar para o login
    </a>

    <div class="error-message" *ngIf="error">
        <i class="fas fa-exclamation-circle"></i>
        {{ error }}
    </div>
</app-login-layout>