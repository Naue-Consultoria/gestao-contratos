<div class="page">
  <div class="page-header">
    <h1 class="page-title">Relatórios</h1>
    <div class="breadcrumb">
      <span>Home</span>
      <span class="breadcrumb-separator">/</span>
      <span>Relatórios</span>
    </div>
  </div>

  <!-- Seletor de Empresa -->
  <div class="company-selector-container">
    <div class="company-selector">
      <label class="selector-label">
        <i class="fas fa-building"></i>
        Selecione a empresa para os relatórios
      </label>
      <div class="selector-wrapper">
        <select 
          class="company-select" 
          [(ngModel)]="selectedCompanyId"
          [disabled]="isLoadingCompanies">
          <option [value]="null">Todas as empresas</option>
          <option *ngFor="let company of companies" [value]="company.id">
            {{ company.name }}
          </option>
        </select>
        <i class="fas fa-chevron-down select-icon"></i>
      </div>
      <p class="selector-hint">
        Alguns relatórios podem ser gerados para empresas específicas ou para todas.
      </p>
    </div>
  </div>

  <!-- Cards de Relatórios -->
  <div class="dashboard-grid">
    <div class="stat-card report-card" (click)="onGenerateReport('monthly')">
      <div class="stat-icon">
        <i class="fas fa-calendar-alt"></i>
      </div>
      <h3 class="report-title">Relatório Mensal</h3>
      <p class="report-description">Resumo completo das atividades do mês com métricas detalhadas</p>
      <div class="report-scope">
        <i class="fas fa-globe"></i>
        <span>Geral</span>
      </div>
      <button class="btn btn-primary full-width">
        <i class="fas fa-download"></i>
        Gerar Relatório
      </button>
    </div>
    
    <div class="stat-card report-card" 
         [class.needs-selection]="needsCompanySelection('company') && !selectedCompanyId"
         (click)="onGenerateReport('company')">
      <div class="stat-icon company-icon">
        <i class="fas fa-building"></i>
      </div>
      <h3 class="report-title">Relatório por Empresa</h3>
      <p class="report-description">Análise detalhada de desempenho por cliente específico</p>
      <div class="report-scope">
        <i class="fas fa-filter"></i>
        <span>{{ selectedCompanyId ? 'Empresa selecionada' : 'Selecione uma empresa' }}</span>
      </div>
      <button class="btn btn-primary full-width">
        <i class="fas fa-download"></i>
        Gerar Relatório
      </button>
    </div>
    
    <div class="stat-card report-card" (click)="onGenerateReport('services')">
      <div class="stat-icon services-icon">
        <i class="fas fa-tasks"></i>
      </div>
      <h3 class="report-title">Relatório de Serviços</h3>
      <p class="report-description">Análise detalhada de performance dos serviços prestados</p>
      <div class="report-scope">
        <i class="fas fa-globe"></i>
        <span>Geral</span>
      </div>
      <button class="btn btn-primary full-width">
        <i class="fas fa-download"></i>
        Gerar Relatório
      </button>
    </div>
    
    <div class="stat-card report-card" 
         [class.needs-selection]="needsCompanySelection('financial') && !selectedCompanyId"
         (click)="onGenerateReport('financial')">
      <div class="stat-icon financial-icon">
        <i class="fas fa-chart-pie"></i>
      </div>
      <h3 class="report-title">Relatório Financeiro</h3>
      <p class="report-description">Análise completa de receitas e projeções financeiras</p>
      <div class="report-scope">
        <i class="fas fa-filter"></i>
        <span>{{ selectedCompanyId ? 'Empresa selecionada' : 'Selecione uma empresa' }}</span>
      </div>
      <button class="btn btn-primary full-width">
        <i class="fas fa-download"></i>
        Gerar Relatório
      </button>
    </div>
  </div>

  <!-- Gráfico de Performance Anual -->
  <div class="chart-container">
    <div class="chart-header">
      <h2 class="chart-title">Performance Anual</h2>
      <div class="chart-actions">
        <button 
          class="chart-action" 
          [class.active]="currentPerformanceYear === 2024"
          (click)="onUpdateChart(2024)">2024</button>
        <button 
          class="chart-action" 
          [class.active]="currentPerformanceYear === 2023"
          (click)="onUpdateChart(2023)">2023</button>
        <button 
          class="chart-action" 
          [class.active]="currentPerformanceYear === 2022"
          (click)="onUpdateChart(2022)">2022</button>
      </div>
    </div>
    <div class="chart-wrapper">
      <canvas id="performanceChart"></canvas>
    </div>
  </div>
</div>