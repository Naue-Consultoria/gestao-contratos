<div class="page-header">
  <h1 class="page-title">Usuários</h1>
  <div class="breadcrumb">
    <span>Home</span>
    <span class="breadcrumb-separator">/</span>
    <span>Usuários</span>
  </div>
</div>

<div class="table-container">
  <div class="table-header">
    <h2 class="table-title">Lista de Usuários</h2>
    <button class="btn btn-primary" (click)="openNewUserPage()">
      <i class="fas fa-plus"></i>
      Novo Usuário
    </button>
  </div>
  
  <!-- Loading state -->
  <div *ngIf="loading" class="loading-container">
    <i class="fas fa-spinner fa-spin"></i>
    <span>Carregando usuários...</span>
  </div>
  
  <!-- Users table -->
  <div class="table-wrapper" *ngIf="!loading">
    <table class="custom-table" *ngIf="users.length > 0">
      <thead>
        <tr>
          <th>USUÁRIO</th>
          <th>EMAIL</th>
          <th>PERMISSÃO</th>
          <th>STATUS</th>
          <th>DESDE</th>
          <th>AÇÕES</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of users; trackBy: trackByUserId" class="clickable" (click)="editUser(user.id)">
          <td>
            <div class="user-info">
              <div class="user-avatar" [style.background]="user.avatarGradient">
                {{ user.initials }}
              </div>
              <div class="user-details">
                <span class="user-name">{{ user.name }}</span>
                <span class="user-role">{{ user.role }}</span>
              </div>
            </div>
          </td>
          <td>
            <span class="user-email">{{ user.email }}</span>
          </td>
          <td>
            <span class="permission-badge" 
                  [class.admin]="user.permission === 'Admin'">
              {{ user.permission }}
            </span>
          </td>
          <td>
            <div class="status-wrapper">
              <span class="status-badge" 
                    [class.active]="user.status === 'active'" 
                    [class.inactive]="user.status === 'inactive'">
                <i class="fas fa-circle"></i>
                {{ user.status === 'active' ? 'Ativo' : 'Inativo' }}
              </span>
              <div *ngIf="user.must_change_password" 
                   class="warning-icon" 
                   title="Usuário precisa alterar a senha">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
            </div>
          </td>
          <td>
            <span class="year-text">{{ user.since }}</span>
          </td>
          <td>
            <div class="action-buttons" (click)="$event.stopPropagation()">
              <button class="action-btn" 
                      title="Editar" 
                      (click)="editUser(user.id)">
                <i class="fas fa-edit"></i>
              </button>
              <button class="action-btn" 
                      title="Resetar Senha" 
                      (click)="resetPassword(user.id)">
                <i class="fas fa-key"></i>
              </button>
              <button class="action-btn" 
                      title="{{ user.status === 'active' ? 'Desativar' : 'Ativar' }}" 
                      (click)="toggleUserStatus(user.id)">
                <i class="fas" 
                   [ngClass]="user.status === 'active' ? 'fa-user-slash' : 'fa-user-check'"></i>
              </button>
              <button class="action-btn danger" 
                      title="Excluir" 
                      (click)="deleteUser(user.id)">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    
    <!-- Empty state -->
    <div *ngIf="users.length === 0" class="empty-state">
      <i class="fas fa-users empty-icon"></i>
      <h3>Nenhum usuário cadastrado</h3>
      <p>Clique no botão "Novo Usuário" para adicionar o primeiro usuário.</p>
    </div>
  </div>
</div>