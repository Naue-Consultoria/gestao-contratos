<div class="page">
  <!-- Header -->
  <div class="page-header">
    <div class="header-title-section">
      <h1 class="page-title">{{ getClienteNome() }}</h1>
      <app-breadcrumb></app-breadcrumb>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner"></div>
    <p>Carregando mentoria...</p>
  </div>

  <!-- Content -->
  <div *ngIf="!isLoading && mentoria" class="mentoria-content">

    <!-- Informações da Mentoria -->
    <div class="mentoria-info-card">
      <div class="info-header">
        <div class="header-left">
          <div class="client-icon">
            <i class="fas fa-building"></i>
          </div>
          <div>
            <h2>{{ getClienteNome() }}</h2>
            <p class="client-email">{{ mentoria.client?.email || 'Email não informado' }}</p>
          </div>
        </div>
        <div class="header-right">
          <span [class]="'status-badge ' + getStatusBadgeClass(mentoria.status)">
            {{ getStatusLabel(mentoria.status) }}
          </span>
          <button class="btn-icon-action" *ngIf="mentoria.unique_token" (click)="visualizarHub()" title="Visualizar Hub Público">
            <i class="fas fa-globe"></i>
          </button>
          <button class="btn-icon-action" *ngIf="mentoria.unique_token" (click)="copiarLinkHub()" title="Copiar Link do Hub">
            <i class="fas fa-link"></i>
          </button>
          <button class="btn-icon-action" (click)="editarMentoria()" title="Editar Mentoria">
            <i class="fas fa-edit"></i>
          </button>
          <button class="btn-icon-action danger" (click)="excluirMentoria()" title="Excluir Mentoria">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>

      <div class="info-grid">
        <div class="info-item">
          <i class="fas fa-file-contract"></i>
          <div class="info-details">
            <span class="info-label">Contrato</span>
            <span class="info-value">{{ mentoria.contract?.contract_number || 'N/A' }}</span>
          </div>
        </div>

        <div class="info-item">
          <i class="fas fa-calendar-alt"></i>
          <div class="info-details">
            <span class="info-label">Total de Encontros</span>
            <span class="info-value">{{ mentoria.numero_encontros }}</span>
          </div>
        </div>

        <div class="info-item">
          <i class="fas fa-check-circle"></i>
          <div class="info-details">
            <span class="info-label">Publicados</span>
            <span class="info-value">{{ getEncontrosPublicados() }}</span>
          </div>
        </div>

        <div class="info-item">
          <i class="fas fa-edit"></i>
          <div class="info-details">
            <span class="info-label">Rascunhos</span>
            <span class="info-value">{{ getEncontrosRascunho() }}</span>
          </div>
        </div>

        <div class="info-item">
          <i class="fas fa-user"></i>
          <div class="info-details">
            <span class="info-label">Criado por</span>
            <span class="info-value">{{ mentoria.criador?.name || 'N/A' }}</span>
          </div>
        </div>

        <div class="info-item">
          <i class="fas fa-clock"></i>
          <div class="info-details">
            <span class="info-label">Criado em</span>
            <span class="info-value">{{ formatarData(mentoria.created_at) }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Encontros Header -->
    <div class="encontros-section-header">
      <h3>
        <i class="fas fa-list"></i>
        Encontros da Mentoria
      </h3>
      <button class="btn-add" (click)="adicionarEncontros()">
        <i class="fas fa-plus"></i>
        Adicionar Encontros
      </button>
    </div>

    <!-- Encontros Grid -->
    <div *ngIf="mentoria.encontros && mentoria.encontros.length > 0" class="encontros-grid">
      <div *ngFor="let encontro of mentoria.encontros" class="encontro-card">
        <!-- Card Header -->
        <div class="encontro-header">
          <div class="encontro-numero">
            {{ encontro.numero_encontro }}
          </div>
          <div class="encontro-status-badge">
            <span [class]="'status-badge-small ' + getStatusBadgeClass(encontro.status)">
              {{ getStatusLabel(encontro.status) }}
            </span>
            <span class="token-expiry" *ngIf="isTokenExpirado(encontro)">
              <i class="fas fa-exclamation-triangle"></i>
              Expirado
            </span>
          </div>
        </div>

        <!-- Card Body -->
        <div class="encontro-body">
          <h4>{{ encontro.mentorado_nome }}</h4>
          <div class="encontro-meta">
            <div class="meta-item">
              <i class="fas fa-calendar-alt"></i>
              <span>{{ formatarData(encontro.data_encontro) }}</span>
            </div>
          </div>

          <div class="encontro-preview" *ngIf="encontro.visao_geral">
            <p>{{ encontro.visao_geral }}</p>
          </div>
        </div>

        <!-- Card Actions -->
        <div class="encontro-actions">
          <button
            class="btn-action-card"
            *ngIf="encontro.status === 'draft'"
            (click)="publicarEncontro(encontro)"
            title="Publicar">
            <i class="fas fa-paper-plane"></i>
            <span>Publicar</span>
          </button>

          <button
            class="btn-action-card"
            *ngIf="encontro.status === 'published'"
            (click)="visualizarEncontro(encontro)"
            title="Visualizar">
            <i class="fas fa-external-link-alt"></i>
            <span>Visualizar</span>
          </button>

          <button
            class="btn-action-card"
            *ngIf="encontro.status === 'published'"
            (click)="copiarLink(encontro)"
            title="Copiar Link">
            <i class="fas fa-copy"></i>
            <span>Copiar Link</span>
          </button>

          <button
            class="btn-action-card"
            (click)="editarEncontro(encontro.id)"
            title="Editar Informações">
            <i class="fas fa-edit"></i>
            <span>Editar</span>
          </button>

          <button
            class="btn-action-card primary"
            (click)="editarConteudo(encontro.id)"
            title="Editar Conteúdo">
            <i class="fas fa-file-alt"></i>
            <span>Conteúdo</span>
          </button>

          <button
            class="btn-action-card danger"
            (click)="excluirEncontro(encontro)"
            title="Excluir Encontro">
            <i class="fas fa-trash"></i>
            <span>Excluir</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!mentoria.encontros || mentoria.encontros.length === 0" class="empty-encontros">
      <i class="fas fa-calendar-times"></i>
      <h3>Nenhum encontro cadastrado</h3>
      <p>Adicione encontros para esta mentoria</p>
      <button class="btn-primary" (click)="adicionarEncontros()">
        <i class="fas fa-plus"></i>
        Adicionar Encontros
      </button>
    </div>
  </div>
</div>
