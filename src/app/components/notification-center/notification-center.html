<!-- Notification Center Modal -->
<div class="notification-center-overlay" (click)="close.emit()" *ngIf="isOpen">
  <div class="notification-center-modal" (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="notification-center-header">
      <h2>
        <i class="fas fa-bell"></i>
        Notificações
      </h2>
      <div class="header-actions">
        <button 
          class="action-btn" 
          (click)="markAllAsRead()"
          [disabled]="unreadCount === 0"
          title="Marcar todas como lidas">
          <i class="fas fa-check-double"></i>
          Marcar todas como lidas
        </button>
        <button class="close-btn" (click)="close.emit()" title="Fechar">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>

    <!-- Filters -->
    <div class="notification-filters">
      <button 
        class="filter-btn"
        [class.active]="activeFilter === 'all'"
        (click)="setFilter('all')">
        Todas ({{ totalCount }})
      </button>
      <button 
        class="filter-btn"
        [class.active]="activeFilter === 'unread'"
        (click)="setFilter('unread')">
        Não lidas ({{ unreadCount }})
      </button>
    </div>

    <!-- Notification List -->
    <div class="notification-center-content" 
         #scrollContainer
         (scroll)="onScroll($event)">
      
      <!-- Loading indicator -->
      <div class="loading-indicator" *ngIf="isLoading">
        <i class="fas fa-spinner fa-spin"></i>
        Carregando notificações...
      </div>

      <!-- Empty state -->
      <div class="empty-state" *ngIf="!isLoading && displayedNotifications.length === 0">
        <i class="fas fa-bell-slash"></i>
        <h3>{{ activeFilter === 'unread' ? 'Nenhuma notificação não lida' : 'Nenhuma notificação' }}</h3>
        <p>{{ activeFilter === 'unread' ? 'Todas as suas notificações foram lidas!' : 'Quando você receber notificações, elas aparecerão aqui.' }}</p>
      </div>

      <!-- Notification items -->
      <div class="notification-list">
        <div 
          *ngFor="let notification of displayedNotifications; trackBy: trackById"
          class="notification-item"
          [class.unread]="!notification.isRead"
          [class.high-priority]="notification.priority === 'high'"
          (click)="handleNotificationClick(notification)">
          
          <div class="notification-icon" [class]="'type-' + notification.type">
            <i [class]="notification.icon"></i>
          </div>
          
          <div class="notification-content">
            <div class="notification-header-item">
              <div class="notification-title">{{ notification.title }}</div>
              <div class="notification-time">{{ formatTime(notification.timestamp) }}</div>
            </div>
            <div class="notification-message">{{ notification.message }}</div>
            
            <!-- Priority indicator -->
            <div class="notification-priority" *ngIf="notification.priority === 'high'">
              <i class="fas fa-exclamation-triangle"></i>
              Alta prioridade
            </div>
          </div>

          <!-- Action buttons -->
          <div class="notification-actions">
            <button 
              class="action-btn small"
              *ngIf="!notification.isRead"
              (click)="markAsRead(notification, $event)"
              title="Marcar como lida">
              <i class="fas fa-check"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Load more indicator -->
      <div class="load-more-indicator" *ngIf="hasMoreNotifications && !isLoading">
        <i class="fas fa-arrow-down"></i>
        Role para carregar mais
      </div>

      <!-- End of list indicator -->
      <div class="end-of-list" *ngIf="!hasMoreNotifications && displayedNotifications.length > 0">
        <i class="fas fa-check-circle"></i>
        Você visualizou todas as notificações
      </div>
    </div>
  </div>
</div>
