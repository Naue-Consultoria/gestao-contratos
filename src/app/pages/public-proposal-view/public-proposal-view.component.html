<!DOCTYPE html>
<div class="proposal-landing">
  
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-container">
      <div class="hero-content">
        <div class="hero-left">
          <div class="company-branding">
            <div class="logo-container">
              <img src="/iconNaue.jpg" alt="NAUE Consultoria" class="company-logo">
            </div>
            <div class="company-info">
              <h1 class="company-name">NAUE Consultoria</h1>
              <p class="company-tagline">Primeira consultoria especializada em mercado<br>imobiliário do Brasil.</p>
            </div>
          </div>
          
          <!-- Proposal Info -->
          <div class="proposal-info">
            <h2 class="proposal-type">
              Proposta <span class="outline-text" data-text="Estratégica">Estratégica</span><span class="green-dot">.</span>
            </h2>
            <div class="client-name" *ngIf="proposal">
              <!-- Debug: {{ proposal | json }} -->
              {{ proposal.client?.trade_name || proposal.client?.name || 'Cliente' }}
            </div>
          </div>
          
        </div>
        
        <div class="hero-right">
          <div class="ceo-presentation">
            <div class="ceo-image-container">
              <img src="/naue.jpg" alt="Mariana Naue" class="ceo-photo" (error)="onImageError($event)">
              <div class="ceo-title">CEO & FUNDADORA</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- About Section -->
  <section class="about-section">
    <div class="section-container">
      <div class="about-content">
        <!-- Left Side: Statistics Cards -->
        <div class="about-left">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-number">+15</div>
              <div class="stat-text">Anos no Mercado</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">+1500</div>
              <div class="stat-text">Líderes Transformados</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">+100</div>
              <div class="stat-text">Empresas Atendidas</div>
            </div>
            <div class="stat-card">
              <div class="stat-number">380%</div>
              <div class="stat-text">ROI em 18 Meses</div>
            </div>
          </div>
        </div>
        
        <!-- Center: Brazil Map -->
        <div class="about-center">
          <div class="brazil-map">
            <img src="/estados.png" alt="Mapa do Brasil - Estados" class="map-image" (error)="onImageError($event)">
          </div>
        </div>
        
        <!-- Right Side: Presence Info -->
        <div class="about-right">
          <div class="presence-section">
            <h3 class="presence-title">Presença Nacional</h3>
            <div class="locations-list">
              <div class="location-item">1. Espírito Santo-ES</div>
              <div class="location-item">2. Goiás-GO</div>
              <div class="location-item">3. Mato Grosso-MT</div>
              <div class="location-item">4. Paraíba-PB</div>
              <div class="location-item">5. Pernambuco-PE</div>
              <div class="location-item">6. Paraná-PR</div>
              <div class="location-item">7. Rio de Janeiro-RJ</div>
              <div class="location-item">8. Tocantins-TO</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Team Section -->
  <section class="team-section">
    <div class="section-container">
      <div class="team-content">
        <!-- Section Header -->
        <div class="team-header">
          <h2 class="team-title">
            <span class="no-wrap">Nosso Time de <span class="highlight-text">Especialistas</span></span>
          </h2>
          <p class="team-subtitle">
            Profissionais altamente qualificados e experientes, dedicados ao sucesso do seu projeto imobiliário
          </p>
        </div>
        
        <!-- Team Members Grid -->
        <div class="team-grid-container">
          <!-- Loading State -->
          <div *ngIf="teamLoading" class="team-loading">
            <div class="loading-spinner"></div>
            <p>Carregando nossa equipe de especialistas...</p>
          </div>
          
          <!-- Team Grid -->
          <div class="team-members-grid" *ngIf="!teamLoading && teamMembers.length > 0">
            <div *ngFor="let member of teamMembers; trackBy: trackByMemberId" 
                 class="specialist-card">
              
              <!-- Photo Section -->
              <div class="specialist-photo-section">
                <div class="photo-frame">
                  <img *ngIf="getTeamMemberPhotoUrl(member)" 
                       [src]="getTeamMemberPhotoUrl(member)" 
                       [alt]="member.name"
                       class="specialist-photo"
                       (error)="onImageError($event)">
                  <div *ngIf="!getTeamMemberPhotoUrl(member)" class="photo-placeholder">
                    <div class="initials-avatar">
                      {{ getTeamMemberInitials(member.name) }}
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Info Section -->
              <div class="specialist-info">
                <h3 class="specialist-name">{{ member.name }}</h3>
                <p class="specialist-position" *ngIf="member.cargo">{{ member.cargo }}</p>
                <p class="specialist-position" *ngIf="!member.cargo && member.is_fixed">CEO & Fundadora</p>
              </div>
            </div>
          </div>
          
          <!-- Empty State -->
          <div *ngIf="!teamLoading && teamMembers.length === 0" class="team-empty-state">
            <div class="empty-illustration">
              <div class="empty-icon">
                <i class="fas fa-user-friends"></i>
              </div>
              <div class="empty-dots">
                <span></span><span></span><span></span>
              </div>
            </div>
            <h3>Equipe de Especialistas</h3>
            <p>Nossa equipe altamente qualificada está sendo preparada para apresentação.<br>
               Em breve você conhecerá todos os profissionais dedicados ao seu sucesso.</p>
            <div class="empty-features">
              <div class="feature-item">
                <i class="fas fa-graduation-cap"></i>
                <span>Altamente Qualificados</span>
              </div>
              <div class="feature-item">
                <i class="fas fa-award"></i>
                <span>Experiência Comprovada</span>
              </div>
              <div class="feature-item">
                <i class="fas fa-handshake"></i>
                <span>Foco em Resultados</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Clients Partners Section -->
  <section class="partners-section">
    <div class="section-container">
      <div class="section-header">
        <h2 class="section-title">Nossos Clientes Parceiros</h2>
        <p class="section-subtitle">Empresas que confiam na NAUE Consultoria</p>
      </div>
      
      <div class="partners-showcase">
        <div class="partners-carousel" 
             (mouseenter)="pauseCarousel()" 
             (mouseleave)="resumeCarousel()"
             (mousedown)="startDrag($event)"
             (mousemove)="onDrag($event)"
             (mouseup)="endDrag()"
             (mouseleave)="endDrag()"
             (touchstart)="startTouch($event)"
             (touchmove)="onTouchMove($event)"
             (touchend)="endTouch()">
          
          <!-- Carousel Track -->
          <div class="carousel-track"
               [class.is-dragging]="isDragging"
               [style.transform]="currentTransform">
            <div *ngFor="let client of clients; let i = index" class="partner-logo">
              <img [src]="client.logo" 
                   [alt]="client.name" 
                   (error)="onClientLogoError($event)" 
                   draggable="false"
                   width="120"
                   height="80"
                   loading="lazy">
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h3>Carregando sua proposta personalizada...</h3>
      <p>Aguarde enquanto preparamos os detalhes do seu projeto</p>
    </div>
  </div>

  <!-- Main Proposal Content -->
  <div *ngIf="!isLoading && proposal" class="proposal-content">
    
    <!-- Unified Proposal Section -->
    <section class="proposal-unified-section">
      <div class="section-container">

        <div class="proposal-intro-compact">
          <h1 class="proposal-title">Seu Investimento Estratégico</h1>
          <p class="proposal-subtitle">
            Conheça em detalhes cada serviço que será desenvolvido para impulsionar seu negócio. 
            Cada solução foi pensada estrategicamente para gerar resultados concretos e transformar sua empresa.
          </p>
        </div>
        
        <div class="services-table-wrapper">
          <div class="services-table-container">
            <table class="services-table">
              <thead>
                <tr>
                  <th class="col-select">Seleção</th>
                  <th class="col-service">Serviço</th>
                  <th class="col-duration">Duração</th>
                  <th class="col-value">Investimento</th>
                </tr>
              </thead>
              <tbody>
                <tr 
                  *ngFor="let service of proposal.services; let i = index"
                  class="service-row"
                  [class.selected]="isServiceSelected(service.service_id)"
                  [class.unselected]="!isServiceSelected(service.service_id)">
                  
                  <td class="col-select">
                    <div class="checkbox-wrapper">
                      <input 
                        type="checkbox" 
                        [id]="'service-' + service.service_id"
                        [checked]="isServiceSelected(service.service_id)"
                        (change)="toggleService(service.service_id)">
                      <label [for]="'service-' + service.service_id" class="checkbox-label">
                        <span class="checkmark"></span>
                      </label>
                    </div>
                  </td>
                  
                  <td class="col-service">
                    <div class="service-details">
                      <h4 class="service-name">{{ service.service.name }}</h4>
                      <p class="service-description" *ngIf="service.service.description" [innerHTML]="formatDescription(service.service.description)">
                      </p>
                      <div class="service-meta" *ngIf="service.quantity > 1">
                        <span class="quantity-badge">{{ service.quantity }}x unidades</span>
                      </div>
                    </div>
                  </td>
                  
                  
                  <td class="col-duration">
                    <div class="duration-info" *ngIf="service.service.duration_unit && (service.service.duration_amount || service.service.duration_unit === 'Projeto')">
                      <i class="fas fa-clock"></i>
                      <span *ngIf="service.service.duration_unit === 'Projeto'">{{ service.service.duration_unit }}</span>
                      <span *ngIf="service.service.duration_unit !== 'Projeto'">{{ service.service.duration_amount }} {{ service.service.duration_unit }}</span>
                    </div>
                    <div class="duration-info not-specified" *ngIf="!service.service.duration_unit || (!service.service.duration_amount && service.service.duration_unit !== 'Projeto')">
                      <i class="fas fa-minus"></i>
                      <span>A definir</span>
                    </div>
                  </td>
                  
                  <td class="col-value">
                    <div class="value-display">
                      <div class="total-value">{{ formatCurrency(getServiceTotal(service)) }}</div>
                      <div class="unit-value" *ngIf="service.quantity > 1">
                        {{ formatCurrency(getServiceValue(service)) }} cada
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="services-summary">
            <div class="selected-count">
              <i class="fas fa-check-circle"></i>
              <span>{{ getSelectedServicesCount() }} serviços selecionados</span>
            </div>
            <div class="summary-total">
              <div class="total-label">Investimento Total</div>
              <div class="total-amount">{{ formatCurrency(getSelectedTotal()) }}</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Digital Signature Section -->
    <section class="signature-section" *ngIf="proposal.status === 'sent' && !proposalExpired">
      <div class="section-container">
        <div class="section-header">
          <h2 class="section-title">Finalize Sua Proposta</h2>
          <p class="section-subtitle">Preencha os dados abaixo e assine digitalmente para confirmar sua aceitação. Este é o último passo para iniciarmos nossa parceria de sucesso.</p>
        </div>
        
        <div class="signature-form-container">
          <form [formGroup]="signatureForm" class="signature-form">
            
            <!-- Personal Information -->
            <div class="form-section">
              <h3 class="form-section-title">
                <i class="fas fa-user"></i>
                Informações Pessoais
              </h3>
              <div class="form-grid">
                <div class="form-field">
                  <label for="client_name" class="field-label">Nome Completo *</label>
                  <input 
                    type="text" 
                    id="client_name" 
                    formControlName="client_name"
                    class="field-input"
                    placeholder="Digite seu nome completo"
                    [class.error]="isFieldInvalid(signatureForm, 'client_name')">
                  <div class="field-error" *ngIf="isFieldInvalid(signatureForm, 'client_name')">
                    <i class="fas fa-exclamation-circle"></i>
                    Nome completo é obrigatório
                  </div>
                </div>

                <div class="form-field">
                  <label for="client_email" class="field-label">Email *</label>
                  <input 
                    type="email" 
                    id="client_email" 
                    formControlName="client_email"
                    class="field-input"
                    placeholder="seu@email.com"
                    [class.error]="isFieldInvalid(signatureForm, 'client_email')">
                  <div class="field-error" *ngIf="isFieldInvalid(signatureForm, 'client_email')">
                    <i class="fas fa-exclamation-circle"></i>
                    Email válido é obrigatório
                  </div>
                </div>

                <div class="form-field">
                  <label for="client_phone" class="field-label">Telefone</label>
                  <input 
                    type="tel" 
                    id="client_phone" 
                    formControlName="client_phone"
                    class="field-input"
                    placeholder="(11) 99999-9999"
                    maxlength="15"
                    (input)="onPhoneInput($event)"
                    (keypress)="onPhoneKeyPress($event)">
                </div>

                <div class="form-field">
                  <label for="client_document" class="field-label">CPF/CNPJ</label>
                  <input 
                    type="text" 
                    id="client_document" 
                    formControlName="client_document"
                    class="field-input"
                    placeholder="000.000.000-00 ou 00.000.000/0000-00"
                    maxlength="18"
                    (input)="onDocumentInput($event)"
                    (keypress)="onDocumentKeyPress($event)">
                </div>
              </div>
            </div>

            <!-- Digital Signature -->
            <div class="form-section">
              <h3 class="form-section-title">
                <i class="fas fa-signature"></i>
                Assinatura Digital *
              </h3>
              <div class="signature-area">
                <div class="signature-instructions">
                  <p>Desenhe sua assinatura no campo abaixo usando o mouse ou toque na tela</p>
                </div>
                
                <div class="signature-canvas-wrapper">
                  <canvas 
                    #signatureCanvas
                    class="signature-canvas"
                    (mousedown)="startDrawing($event)"
                    (mousemove)="draw($event)"
                    (mouseup)="stopDrawing()"
                    (mouseleave)="stopDrawing()"
                    (touchstart)="startTouchDrawing($event)"
                    (touchmove)="touchDraw($event)"
                    (touchend)="stopTouchDrawing($event)">
                  </canvas>
                  <div class="signature-placeholder" *ngIf="!signatureDrawn">
                    <i class="fas fa-pen"></i>
                    <span>Clique aqui para assinar</span>
                  </div>
                </div>
                
                <div class="signature-actions">
                  <button type="button" class="btn-secondary" (click)="clearSignature()">
                    <i class="fas fa-eraser"></i>
                    Limpar
                  </button>
                  <div class="signature-status" *ngIf="signatureDrawn">
                    <i class="fas fa-check-circle"></i>
                    <span>Assinatura capturada</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Additional Comments -->
            <div class="form-section">
              <h3 class="form-section-title">
                <i class="fas fa-comments"></i>
                Observações Adicionais
              </h3>
              <div class="form-field full-width">
                <label for="client_observations" class="field-label">Comentários ou dúvidas (opcional)</label>
                <textarea 
                  id="client_observations" 
                  formControlName="client_observations"
                  class="field-textarea"
                  placeholder="Adicione qualquer observação, dúvida ou solicitação especial sobre o projeto..."
                  rows="4">
                </textarea>
              </div>
            </div>
            
            <!-- Submit Button -->
            <div class="form-submit-section">
              <button 
                type="button"
                class="btn-submit-signature" 
                [disabled]="!canSignProposal() || isSubmitting"
                (click)="signProposal()">
                <i *ngIf="!isSubmitting" class="fas fa-signature"></i>
                <i *ngIf="isSubmitting" class="fas fa-spinner fa-spin"></i>
                <span *ngIf="!isSubmitting">Aceitar e Assinar Proposta</span>
                <span *ngIf="isSubmitting">Processando assinatura...</span>
              </button>
              
              <div class="requirements-hint" *ngIf="!canSignProposal()">
                <p>Complete todos os campos obrigatórios e adicione sua assinatura digital para prosseguir</p>
              </div>
            </div>
          </form>
        </div>
      </div>
    </section>
  </div>

  <!-- Footer -->
  <footer class="site-footer">
    <div class="footer-container">
      <div class="footer-content">
        <div class="footer-brand">
          <div class="footer-logo">
            <img src="/logoNaue.png" alt="NAUE Consultoria" class="footer-logo-img">
          </div>
          <h4>NAUE Consultoria</h4>
          <p>Transformando o mercado imobiliário brasileiro com excelência e inovação</p>
        </div>
        
        <div class="footer-contact">
          <h4>Contato</h4>
          <div class="contact-item">
            <i class="fas fa-envelope"></i>
            <span>mariana&#64;naueconsultoria.com.br</span>
          </div>
          <div class="contact-item">
            <i class="fas fa-phone"></i>
            <span>(62) 99411-8289</span>
          </div>
          <div class="contact-item">
            <i class="fas fa-map-marker-alt"></i>
            <span>Flamboyant Park Business<br>
            Jardim Goiás, Goiânia - GO</span>
          </div>
          
          <div class="social-media">
            <h5>Siga-nos</h5>
            <div class="social-links">
              <a href="https://instagram.com/naueconsultoria.rh" target="_blank" rel="noopener noreferrer" class="social-link instagram">
                <i class="fab fa-instagram"></i>
              </a>
              <a href="https://linkedin.com/company/naue-consultoria" target="_blank" rel="noopener noreferrer" class="social-link linkedin">
                <i class="fab fa-linkedin-in"></i>
              </a>
            </div>
          </div>
        </div>
        
      </div>
      
      <div class="footer-bottom">
        <p>&copy; {{ currentYear }} NAUE Consultoria. Todos os direitos reservados.</p>
      </div>
    </div>
  </footer>

</div>